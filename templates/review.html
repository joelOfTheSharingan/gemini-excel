<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Review parsed transactions</title>
  <style>
    body{font-family:Arial, sans-serif; max-width:1100px; margin:20px auto;}
    table{border-collapse:collapse; width:100%;}
    th,td{border:1px solid #ddd; padding:8px; text-align:center;}
    th{background:#f4f4f4;}
    input[type=text]{width:100%;}
    select{width:100%;}
    .actions{margin:12px 0;}
  </style>
</head>
<body>
  <h2>Review & correct parsed transactions</h2>
  <form method="post">
    <table>
      <thead>
        <tr><th>#</th><th>Date</th><th>Description</th><th>Amount</th><th>Category</th></tr>
      </thead>
      <tbody>
        {% for i,row in enumerate(rows) %}
        <tr>
          <td>{{ i+1 }}</td>
          <td><input type="text" name="date-{{i}}" value="{{ row.date }}"></td>
          <td><input type="text" name="description-{{i}}" value="{{ row.description }}"></td>
          <td><input type="text" name="amount-{{i}}" value="{{ row.amount }}"></td>
          <td>
            <select name="category-{{i}}">
              {% for cat in categories %}
                <option value="{{cat}}" {% if row.category==cat %}selected{% endif %}>{{cat}}</option>
              {% endfor %}
            </select>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>

    <div class="actions">
      <input type="hidden" name="row-count" value="{{ rows|length }}">
      <button type="submit">Generate Excel</button>
      <a href="{{ url_for('index') }}">Start over</a>
    </div>
  </form>
</body>
</html>
